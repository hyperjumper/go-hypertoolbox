package mime


import (
	"fmt"
	"regexp"
	"strings"
)

type MimeType struct {
	MimeMap map[string]string
}

func (m *MimeType) MimeForFileName(filename string) (string, error) {
	reg := regexp.MustCompile(`[a-zA-Z0-9]+$`)
	if reg.MatchString(filename) {
		ext := reg.FindString(filename)
		return m.MimeForExtension(ext)
	} else {
		return "", fmt.Errorf("can not find extension of file : %s", filename)
	}
}

func (m *MimeType) IsPrintableChar(char byte) bool {
	if char & 0x80 == 0x80 {
		return false
	} else if char >= 0x20 || char == 0x09 || char == 0x0A || char == 0x0D || char == 239 {
		return true
	} else {
		return false
	}
}

func (m *MimeType) IsAllPrintableChar(bytes []byte) bool {
	nonprintable := 0
	for _, b := range bytes{
		if !m.IsPrintableChar(b) {
			nonprintable++
		}
	}
	return float64(nonprintable) / float64(len(bytes)) < 0.03
}

func (m *MimeType) MimeForExtension(extension string) (string, error) {
	ex := strings.ToLower(extension)
	if m.MimeMap == nil {
		m.MimeMap = make(map[string]string)
		m.MimeMap["x3d"] = "application/vnd.hzn-3d-crossword"
		m.MimeMap["3gp"] = "video/3gpp"
		m.MimeMap["3g2"] = "video/3gpp2"
		m.MimeMap["mseq"] = "application/vnd.mseq"
		m.MimeMap["pwn"] = "application/vnd.3m.post-it-notes"
		m.MimeMap["plb"] = "application/vnd.3gpp.pic-bw-large"
		m.MimeMap["psb"] = "application/vnd.3gpp.pic-bw-small"
		m.MimeMap["pvb"] = "application/vnd.3gpp.pic-bw-var"
		m.MimeMap["tcap"] = "application/vnd.3gpp2.tcap"
		m.MimeMap["7z"] = "application/x-7z-compressed"
		m.MimeMap["abw"] = "application/x-abiword"
		m.MimeMap["ace"] = "application/x-ace-compressed"
		m.MimeMap["acc"] = "application/vnd.americandynamics.acc"
		m.MimeMap["acu"] = "application/vnd.acucobol"
		m.MimeMap["atc"] = "application/vnd.acucorp"
		m.MimeMap["adp"] = "audio/adpcm"
		m.MimeMap["aab"] = "application/x-authorware-bin"
		m.MimeMap["aam"] = "application/x-authorware-map"
		m.MimeMap["aas"] = "application/x-authorware-seg"
		m.MimeMap["air"] = "application/vnd.adobe.air-application-installer-package+zip"
		m.MimeMap["swf"] = "application/x-shockwave-flash"
		m.MimeMap["fxp"] = "application/vnd.adobe.fxp"
		m.MimeMap["pdf"] = "application/pdf"
		m.MimeMap["ppd"] = "application/vnd.cups-ppd"
		m.MimeMap["dir"] = "application/x-director"
		m.MimeMap["xdp"] = "application/vnd.adobe.xdp+xml"
		m.MimeMap["xfdf"] = "application/vnd.adobe.xfdf"
		m.MimeMap["aac"] = "audio/x-aac"
		m.MimeMap["ahead"] = "application/vnd.ahead.space"
		m.MimeMap["azf"] = "application/vnd.airzip.filesecure.azf"
		m.MimeMap["azs"] = "application/vnd.airzip.filesecure.azs"
		m.MimeMap["azw"] = "application/vnd.amazon.ebook"
		m.MimeMap["ami"] = "application/vnd.amiga.ami"
		m.MimeMap["N/A"] = "application/andrew-inset"
		m.MimeMap["apk"] = "application/vnd.android.package-archive"
		m.MimeMap["cii"] = "application/vnd.anser-web-certificate-issue-initiation"
		m.MimeMap["fti"] = "application/vnd.anser-web-funds-transfer-initiation"
		m.MimeMap["atx"] = "application/vnd.antix.game-component"
		m.MimeMap["dmg"] = "application/x-apple-diskimage"
		m.MimeMap["mpkg"] = "application/vnd.apple.installer+xml"
		m.MimeMap["aw"] = "application/applixware"
		m.MimeMap["les"] = "application/vnd.hhe.lesson-player"
		m.MimeMap["swi"] = "application/vnd.aristanetworks.swi"
		m.MimeMap["s"] = "text/x-asm"
		m.MimeMap["atomcat"] = "application/atomcat+xml"
		m.MimeMap["atomsvc"] = "application/atomsvc+xml"
		m.MimeMap["atom"] = "application/atom+xml"
		m.MimeMap["xml"] = "application/atom+xml"
		m.MimeMap["ac"] = "application/pkix-attr-cert"
		m.MimeMap["aif"] = "audio/x-aiff"
		m.MimeMap["avi"] = "video/x-msvideo"
		m.MimeMap["aep"] = "application/vnd.audiograph"
		m.MimeMap["dxf"] = "image/vnd.dxf"
		m.MimeMap["dwf"] = "model/vnd.dwf"
		m.MimeMap["par"] = "text/plain-bas"
		m.MimeMap["bcpio"] = "application/x-bcpio"
		m.MimeMap["bin"] = "application/octet-stream"
		m.MimeMap["bmp"] = "image/bmp"
		m.MimeMap["torrent"] = "application/x-bittorrent"
		m.MimeMap["cod"] = "application/vnd.rim.cod"
		m.MimeMap["mpm"] = "application/vnd.blueice.multipass"
		m.MimeMap["bmi"] = "application/vnd.bmi"
		m.MimeMap["sh"] = "application/x-sh"
		m.MimeMap["btif"] = "image/prs.btif"
		m.MimeMap["rep"] = "application/vnd.businessobjects"
		m.MimeMap["bz"] = "application/x-bzip"
		m.MimeMap["bz2"] = "application/x-bzip2"
		m.MimeMap["csh"] = "application/x-csh"
		m.MimeMap["c"] = "text/x-c"
		m.MimeMap["cdxml"] = "application/vnd.chemdraw+xml"
		m.MimeMap["css"] = "text/css"
		m.MimeMap["cdx"] = "chemical/x-cdx"
		m.MimeMap["cml"] = "chemical/x-cml"
		m.MimeMap["csml"] = "chemical/x-csml"
		m.MimeMap["cdbcmsg"] = "application/vnd.contact.cmsg"
		m.MimeMap["cla"] = "application/vnd.claymore"
		m.MimeMap["c4g"] = "application/vnd.clonk.c4group"
		m.MimeMap["sub"] = "image/vnd.dvb.subtitle"
		m.MimeMap["cdmia"] = "application/cdmi-capability"
		m.MimeMap["cdmic"] = "application/cdmi-container"
		m.MimeMap["cdmid"] = "application/cdmi-domain"
		m.MimeMap["cdmio"] = "application/cdmi-object"
		m.MimeMap["cdmiq"] = "application/cdmi-queue"
		m.MimeMap["c11amc"] = "application/vnd.cluetrust.cartomobile-configuration"
		m.MimeMap["c11amz"] = "application/vnd.cluetrust.cartomobile-configuration-pkg"
		m.MimeMap["ras"] = "image/x-cmu-raster"
		m.MimeMap["dae"] = "model/vnd.collada+xml"
		m.MimeMap["csv"] = "text/csv"
		m.MimeMap["cpt"] = "application/mac-compactpro"
		m.MimeMap["wmlc"] = "application/vnd.wap.wmlc"
		m.MimeMap["cgm"] = "image/cgm"
		m.MimeMap["ice"] = "x-conference/x-cooltalk"
		m.MimeMap["cmx"] = "image/x-cmx"
		m.MimeMap["xar"] = "application/vnd.xara"
		m.MimeMap["cmc"] = "application/vnd.cosmocaller"
		m.MimeMap["cpio"] = "application/x-cpio"
		m.MimeMap["clkx"] = "application/vnd.crick.clicker"
		m.MimeMap["clkk"] = "application/vnd.crick.clicker.keyboard"
		m.MimeMap["clkp"] = "application/vnd.crick.clicker.palette"
		m.MimeMap["clkt"] = "application/vnd.crick.clicker.template"
		m.MimeMap["clkw"] = "application/vnd.crick.clicker.wordbank"
		m.MimeMap["wbs"] = "application/vnd.criticaltools.wbs+xml"
		m.MimeMap["cryptonote"] = "application/vnd.rig.cryptonote"
		m.MimeMap["cif"] = "chemical/x-cif"
		m.MimeMap["cmdf"] = "chemical/x-cmdf"
		m.MimeMap["cu"] = "application/cu-seeme"
		m.MimeMap["cww"] = "application/prs.cww"
		m.MimeMap["curl"] = "text/vnd.curl"
		m.MimeMap["dcurl"] = "text/vnd.curl.dcurl"
		m.MimeMap["mcurl"] = "text/vnd.curl.mcurl"
		m.MimeMap["scurl"] = "text/vnd.curl.scurl"
		m.MimeMap["car"] = "application/vnd.curl.car"
		m.MimeMap["pcurl"] = "application/vnd.curl.pcurl"
		m.MimeMap["cmp"] = "application/vnd.yellowriver-custom-menu"
		m.MimeMap["dssc"] = "application/dssc+der"
		m.MimeMap["xdssc"] = "application/dssc+xml"
		m.MimeMap["deb"] = "application/x-debian-package"
		m.MimeMap["uva"] = "audio/vnd.dece.audio"
		m.MimeMap["uvi"] = "image/vnd.dece.graphic"
		m.MimeMap["uvh"] = "video/vnd.dece.hd"
		m.MimeMap["uvm"] = "video/vnd.dece.mobile"
		m.MimeMap["uvu"] = "video/vnd.uvvu.mp4"
		m.MimeMap["uvp"] = "video/vnd.dece.pd"
		m.MimeMap["uvs"] = "video/vnd.dece.sd"
		m.MimeMap["uvv"] = "video/vnd.dece.video"
		m.MimeMap["dvi"] = "application/x-dvi"
		m.MimeMap["seed"] = "application/vnd.fdsn.seed"
		m.MimeMap["dtb"] = "application/x-dtbook+xml"
		m.MimeMap["res"] = "application/x-dtbresource+xml"
		m.MimeMap["ait"] = "application/vnd.dvb.ait"
		m.MimeMap["svc"] = "application/vnd.dvb.service"
		m.MimeMap["eol"] = "audio/vnd.digital-winds"
		m.MimeMap["djvu"] = "image/vnd.djvu"
		m.MimeMap["dtd"] = "application/xml-dtd"
		m.MimeMap["mlp"] = "application/vnd.dolby.mlp"
		m.MimeMap["wad"] = "application/x-doom"
		m.MimeMap["dpg"] = "application/vnd.dpgraph"
		m.MimeMap["dra"] = "audio/vnd.dra"
		m.MimeMap["dfac"] = "application/vnd.dreamfactory"
		m.MimeMap["dts"] = "audio/vnd.dts"
		m.MimeMap["dtshd"] = "audio/vnd.dts.hd"
		m.MimeMap["dwg"] = "image/vnd.dwg"
		m.MimeMap["geo"] = "application/vnd.dynageo"
		m.MimeMap["es"] = "application/ecmascript"
		m.MimeMap["mag"] = "application/vnd.ecowin.chart"
		m.MimeMap["mmr"] = "image/vnd.fujixerox.edmics-mmr"
		m.MimeMap["rlc"] = "image/vnd.fujixerox.edmics-rlc"
		m.MimeMap["exi"] = "application/exi"
		m.MimeMap["mgz"] = "application/vnd.proteus.magazine"
		m.MimeMap["epub"] = "application/epub+zip"
		m.MimeMap["eml"] = "message/rfc822"
		m.MimeMap["nml"] = "application/vnd.enliven"
		m.MimeMap["xpr"] = "application/vnd.is-xpr"
		m.MimeMap["xif"] = "image/vnd.xiff"
		m.MimeMap["xfdl"] = "application/vnd.xfdl"
		m.MimeMap["emma"] = "application/emma+xml"
		m.MimeMap["ez2"] = "application/vnd.ezpix-album"
		m.MimeMap["ez3"] = "application/vnd.ezpix-package"
		m.MimeMap["fst"] = "image/vnd.fst"
		m.MimeMap["fvt"] = "video/vnd.fvt"
		m.MimeMap["fbs"] = "image/vnd.fastbidsheet"
		m.MimeMap["fe_launch"] = "application/vnd.denovo.fcselayout-link"
		m.MimeMap["f4v"] = "video/x-f4v"
		m.MimeMap["flv"] = "video/x-flv"
		m.MimeMap["fpx"] = "image/vnd.fpx"
		m.MimeMap["npx"] = "image/vnd.net-fpx"
		m.MimeMap["flx"] = "text/vnd.fmi.flexstor"
		m.MimeMap["fli"] = "video/x-fli"
		m.MimeMap["ftc"] = "application/vnd.fluxtime.clip"
		m.MimeMap["fdf"] = "application/vnd.fdf"
		m.MimeMap["f"] = "text/x-fortran"
		m.MimeMap["mif"] = "application/vnd.mif"
		m.MimeMap["fm"] = "application/vnd.framemaker"
		m.MimeMap["fh"] = "image/x-freehand"
		m.MimeMap["fsc"] = "application/vnd.fsc.weblaunch"
		m.MimeMap["fnc"] = "application/vnd.frogans.fnc"
		m.MimeMap["ltf"] = "application/vnd.frogans.ltf"
		m.MimeMap["ddd"] = "application/vnd.fujixerox.ddd"
		m.MimeMap["xdw"] = "application/vnd.fujixerox.docuworks"
		m.MimeMap["xbd"] = "application/vnd.fujixerox.docuworks.binder"
		m.MimeMap["oas"] = "application/vnd.fujitsu.oasys"
		m.MimeMap["oa2"] = "application/vnd.fujitsu.oasys2"
		m.MimeMap["oa3"] = "application/vnd.fujitsu.oasys3"
		m.MimeMap["fg5"] = "application/vnd.fujitsu.oasysgp"
		m.MimeMap["bh2"] = "application/vnd.fujitsu.oasysprs"
		m.MimeMap["spl"] = "application/x-futuresplash"
		m.MimeMap["fzs"] = "application/vnd.fuzzysheet"
		m.MimeMap["g3"] = "image/g3fax"
		m.MimeMap["gmx"] = "application/vnd.gmx"
		m.MimeMap["gtw"] = "model/vnd.gtw"
		m.MimeMap["txd"] = "application/vnd.genomatix.tuxedo"
		m.MimeMap["ggb"] = "application/vnd.geogebra.file"
		m.MimeMap["ggt"] = "application/vnd.geogebra.tool"
		m.MimeMap["gdl"] = "model/vnd.gdl"
		m.MimeMap["gex"] = "application/vnd.geometry-explorer"
		m.MimeMap["gxt"] = "application/vnd.geonext"
		m.MimeMap["g2w"] = "application/vnd.geoplan"
		m.MimeMap["g3w"] = "application/vnd.geospace"
		m.MimeMap["gsf"] = "application/x-font-ghostscript"
		m.MimeMap["bdf"] = "application/x-font-bdf"
		m.MimeMap["gtar"] = "application/x-gtar"
		m.MimeMap["texinfo"] = "application/x-texinfo"
		m.MimeMap["gnumeric"] = "application/x-gnumeric"
		m.MimeMap["kml"] = "application/vnd.google-earth.kml+xml"
		m.MimeMap["kmz"] = "application/vnd.google-earth.kmz"
		m.MimeMap["gqf"] = "application/vnd.grafeq"
		m.MimeMap["gif"] = "image/gif"
		m.MimeMap["gv"] = "text/vnd.graphviz"
		m.MimeMap["gac"] = "application/vnd.groove-account"
		m.MimeMap["ghf"] = "application/vnd.groove-help"
		m.MimeMap["gim"] = "application/vnd.groove-identity-message"
		m.MimeMap["grv"] = "application/vnd.groove-injector"
		m.MimeMap["gtm"] = "application/vnd.groove-tool-message"
		m.MimeMap["tpl"] = "application/vnd.groove-tool-template"
		m.MimeMap["vcg"] = "application/vnd.groove-vcard"
		m.MimeMap["h261"] = "video/h261"
		m.MimeMap["h263"] = "video/h263"
		m.MimeMap["h264"] = "video/h264"
		m.MimeMap["hpid"] = "application/vnd.hp-hpid"
		m.MimeMap["hps"] = "application/vnd.hp-hps"
		m.MimeMap["hdf"] = "application/x-hdf"
		m.MimeMap["rip"] = "audio/vnd.rip"
		m.MimeMap["hbci"] = "application/vnd.hbci"
		m.MimeMap["jlt"] = "application/vnd.hp-jlyt"
		m.MimeMap["pcl"] = "application/vnd.hp-pcl"
		m.MimeMap["hpgl"] = "application/vnd.hp-hpgl"
		m.MimeMap["hvs"] = "application/vnd.yamaha.hv-script"
		m.MimeMap["hvd"] = "application/vnd.yamaha.hv-dic"
		m.MimeMap["hvp"] = "application/vnd.yamaha.hv-voice"
		m.MimeMap["sfd-hdstx"] = "application/vnd.hydrostatix.sof-data"
		m.MimeMap["stk"] = "application/hyperstudio"
		m.MimeMap["hal"] = "application/vnd.hal+xml"
		m.MimeMap["html"] = "text/html"
		m.MimeMap["irm"] = "application/vnd.ibm.rights-management"
		m.MimeMap["sc"] = "application/vnd.ibm.secure-container"
		m.MimeMap["ics"] = "text/calendar"
		m.MimeMap["icc"] = "application/vnd.iccprofile"
		m.MimeMap["ico"] = "image/x-icon"
		m.MimeMap["igl"] = "application/vnd.igloader"
		m.MimeMap["ief"] = "image/ief"
		m.MimeMap["ivp"] = "application/vnd.immervision-ivp"
		m.MimeMap["ivu"] = "application/vnd.immervision-ivu"
		m.MimeMap["rif"] = "application/reginfo+xml"
		m.MimeMap["3dml"] = "text/vnd.in3d.3dml"
		m.MimeMap["spot"] = "text/vnd.in3d.spot"
		m.MimeMap["igs"] = "model/iges"
		m.MimeMap["i2g"] = "application/vnd.intergeo"
		m.MimeMap["cdy"] = "application/vnd.cinderella"
		m.MimeMap["xpw"] = "application/vnd.intercon.formnet"
		m.MimeMap["fcs"] = "application/vnd.isac.fcs"
		m.MimeMap["ipfix"] = "application/ipfix"
		m.MimeMap["cer"] = "application/pkix-cert"
		m.MimeMap["pki"] = "application/pkixcmp"
		m.MimeMap["crl"] = "application/pkix-crl"
		m.MimeMap["pkipath"] = "application/pkix-pkipath"
		m.MimeMap["igm"] = "application/vnd.insors.igm"
		m.MimeMap["rcprofile"] = "application/vnd.ipunplugged.rcprofile"
		m.MimeMap["irp"] = "application/vnd.irepository.package+xml"
		m.MimeMap["jad"] = "text/vnd.sun.j2me.app-descriptor"
		m.MimeMap["jar"] = "application/java-archive"
		m.MimeMap["class"] = "application/java-vm"
		m.MimeMap["jnlp"] = "application/x-java-jnlp-file"
		m.MimeMap["ser"] = "application/java-serialized-object"
		m.MimeMap["java"] = "text/x-java-source,java"
		m.MimeMap["js"] = "application/javascript"
		m.MimeMap["json"] = "application/json"
		m.MimeMap["joda"] = "application/vnd.joost.joda-archive"
		m.MimeMap["jpm"] = "video/jpm"
		m.MimeMap["jpeg"] = "image/jpeg"
		m.MimeMap["jpg"] = "image/jpeg"
		m.MimeMap["pjpeg"] = "image/pjpeg"
		m.MimeMap["jpgv"] = "video/jpeg"
		m.MimeMap["ktz"] = "application/vnd.kahootz"
		m.MimeMap["mmd"] = "application/vnd.chipnuts.karaoke-mmd"
		m.MimeMap["karbon"] = "application/vnd.kde.karbon"
		m.MimeMap["chrt"] = "application/vnd.kde.kchart"
		m.MimeMap["kfo"] = "application/vnd.kde.kformula"
		m.MimeMap["flw"] = "application/vnd.kde.kivio"
		m.MimeMap["kon"] = "application/vnd.kde.kontour"
		m.MimeMap["kpr"] = "application/vnd.kde.kpresenter"
		m.MimeMap["ksp"] = "application/vnd.kde.kspread"
		m.MimeMap["kwd"] = "application/vnd.kde.kword"
		m.MimeMap["htke"] = "application/vnd.kenameaapp"
		m.MimeMap["kia"] = "application/vnd.kidspiration"
		m.MimeMap["kne"] = "application/vnd.kinar"
		m.MimeMap["sse"] = "application/vnd.kodak-descriptor"
		m.MimeMap["lasxml"] = "application/vnd.las.las+xml"
		m.MimeMap["latex"] = "application/x-latex"
		m.MimeMap["lbd"] = "application/vnd.llamagraphics.life-balance.desktop"
		m.MimeMap["lbe"] = "application/vnd.llamagraphics.life-balance.exchange+xml"
		m.MimeMap["jam"] = "application/vnd.jam"
		m.MimeMap["123"] = "application/vnd.lotus-1-2-3"
		m.MimeMap["apr"] = "application/vnd.lotus-approach"
		m.MimeMap["pre"] = "application/vnd.lotus-freelance"
		m.MimeMap["nsf"] = "application/vnd.lotus-notes"
		m.MimeMap["org"] = "application/vnd.lotus-organizer"
		m.MimeMap["scm"] = "application/vnd.lotus-screencam"
		m.MimeMap["lwp"] = "application/vnd.lotus-wordpro"
		m.MimeMap["lvp"] = "audio/vnd.lucent.voice"
		m.MimeMap["m3u"] = "audio/x-mpegurl"
		m.MimeMap["m4v"] = "video/x-m4v"
		m.MimeMap["hqx"] = "application/mac-binhex40"
		m.MimeMap["portpkg"] = "application/vnd.macports.portpkg"
		m.MimeMap["mgp"] = "application/vnd.osgeo.mapguide.package"
		m.MimeMap["mrc"] = "application/marc"
		m.MimeMap["mrcx"] = "application/marcxml+xml"
		m.MimeMap["mxf"] = "application/mxf"
		m.MimeMap["nbp"] = "application/vnd.wolfram.player"
		m.MimeMap["ma"] = "application/mathematica"
		m.MimeMap["mathml"] = "application/mathml+xml"
		m.MimeMap["mbox"] = "application/mbox"
		m.MimeMap["mc1"] = "application/vnd.medcalcdata"
		m.MimeMap["mscml"] = "application/mediaservercontrol+xml"
		m.MimeMap["cdkey"] = "application/vnd.mediastation.cdkey"
		m.MimeMap["mwf"] = "application/vnd.mfer"
		m.MimeMap["mfm"] = "application/vnd.mfmp"
		m.MimeMap["msh"] = "model/mesh"
		m.MimeMap["mads"] = "application/mads+xml"
		m.MimeMap["mets"] = "application/mets+xml"
		m.MimeMap["mods"] = "application/mods+xml"
		m.MimeMap["meta4"] = "application/metalink4+xml"
		m.MimeMap["mcd"] = "application/vnd.mcd"
		m.MimeMap["flo"] = "application/vnd.micrografx.flo"
		m.MimeMap["igx"] = "application/vnd.micrografx.igx"
		m.MimeMap["es3"] = "application/vnd.eszigno3+xml"
		m.MimeMap["mdb"] = "application/x-msaccess"
		m.MimeMap["asf"] = "video/x-ms-asf"
		m.MimeMap["exe"] = "application/x-msdownload"
		m.MimeMap["cil"] = "application/vnd.ms-artgalry"
		m.MimeMap["cab"] = "application/vnd.ms-cab-compressed"
		m.MimeMap["ims"] = "application/vnd.ms-ims"
		m.MimeMap["application"] = "application/x-ms-application"
		m.MimeMap["clp"] = "application/x-msclip"
		m.MimeMap["mdi"] = "image/vnd.ms-modi"
		m.MimeMap["eot"] = "application/vnd.ms-fontobject"
		m.MimeMap["xls"] = "application/vnd.ms-excel"
		m.MimeMap["xlam"] = "application/vnd.ms-excel.addin.macroenabled.12"
		m.MimeMap["xlsb"] = "application/vnd.ms-excel.sheet.binary.macroenabled.12"
		m.MimeMap["xltm"] = "application/vnd.ms-excel.template.macroenabled.12"
		m.MimeMap["xlsm"] = "application/vnd.ms-excel.sheet.macroenabled.12"
		m.MimeMap["chm"] = "application/vnd.ms-htmlhelp"
		m.MimeMap["crd"] = "application/x-mscardfile"
		m.MimeMap["lrm"] = "application/vnd.ms-lrm"
		m.MimeMap["mvb"] = "application/x-msmediaview"
		m.MimeMap["mny"] = "application/x-msmoney"
		m.MimeMap["pptx"] = "application/vnd.openxmlformats-officedocument.presentationml.presentation"
		m.MimeMap["sldx"] = "application/vnd.openxmlformats-officedocument.presentationml.slide"
		m.MimeMap["ppsx"] = "application/vnd.openxmlformats-officedocument.presentationml.slideshow"
		m.MimeMap["potx"] = "application/vnd.openxmlformats-officedocument.presentationml.template"
		m.MimeMap["xlsx"] = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
		m.MimeMap["xltx"] = "application/vnd.openxmlformats-officedocument.spreadsheetml.template"
		m.MimeMap["docx"] = "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
		m.MimeMap["dotx"] = "application/vnd.openxmlformats-officedocument.wordprocessingml.template"
		m.MimeMap["obd"] = "application/x-msbinder"
		m.MimeMap["thmx"] = "application/vnd.ms-officetheme"
		m.MimeMap["onetoc"] = "application/onenote"
		m.MimeMap["pya"] = "audio/vnd.ms-playready.media.pya"
		m.MimeMap["pyv"] = "video/vnd.ms-playready.media.pyv"
		m.MimeMap["ppt"] = "application/vnd.ms-powerpoint"
		m.MimeMap["ppam"] = "application/vnd.ms-powerpoint.addin.macroenabled.12"
		m.MimeMap["sldm"] = "application/vnd.ms-powerpoint.slide.macroenabled.12"
		m.MimeMap["pptm"] = "application/vnd.ms-powerpoint.presentation.macroenabled.12"
		m.MimeMap["ppsm"] = "application/vnd.ms-powerpoint.slideshow.macroenabled.12"
		m.MimeMap["potm"] = "application/vnd.ms-powerpoint.template.macroenabled.12"
		m.MimeMap["mpp"] = "application/vnd.ms-project"
		m.MimeMap["pub"] = "application/x-mspublisher"
		m.MimeMap["scd"] = "application/x-msschedule"
		m.MimeMap["xap"] = "application/x-silverlight-app"
		m.MimeMap["stl"] = "application/vnd.ms-pki.stl"
		m.MimeMap["cat"] = "application/vnd.ms-pki.seccat"
		m.MimeMap["vsd"] = "application/vnd.visio"
		m.MimeMap["vsdx"] = "application/vnd.visio2013"
		m.MimeMap["wm"] = "video/x-ms-wm"
		m.MimeMap["wma"] = "audio/x-ms-wma"
		m.MimeMap["wax"] = "audio/x-ms-wax"
		m.MimeMap["wmx"] = "video/x-ms-wmx"
		m.MimeMap["wmd"] = "application/x-ms-wmd"
		m.MimeMap["wpl"] = "application/vnd.ms-wpl"
		m.MimeMap["wmz"] = "application/x-ms-wmz"
		m.MimeMap["wmv"] = "video/x-ms-wmv"
		m.MimeMap["wvx"] = "video/x-ms-wvx"
		m.MimeMap["wmf"] = "application/x-msmetafile"
		m.MimeMap["trm"] = "application/x-msterminal"
		m.MimeMap["doc"] = "application/msword"
		m.MimeMap["docm"] = "application/vnd.ms-word.document.macroenabled.12"
		m.MimeMap["dotm"] = "application/vnd.ms-word.template.macroenabled.12"
		m.MimeMap["wri"] = "application/x-mswrite"
		m.MimeMap["wps"] = "application/vnd.ms-works"
		m.MimeMap["xbap"] = "application/x-ms-xbap"
		m.MimeMap["xps"] = "application/vnd.ms-xpsdocument"
		m.MimeMap["mid"] = "audio/midi"
		m.MimeMap["mpy"] = "application/vnd.ibm.minipay"
		m.MimeMap["afp"] = "application/vnd.ibm.modcap"
		m.MimeMap["rms"] = "application/vnd.jcp.javame.midlet-rms"
		m.MimeMap["tmo"] = "application/vnd.tmobile-livetv"
		m.MimeMap["prc"] = "application/x-mobipocket-ebook"
		m.MimeMap["mbk"] = "application/vnd.mobius.mbk"
		m.MimeMap["dis"] = "application/vnd.mobius.dis"
		m.MimeMap["plc"] = "application/vnd.mobius.plc"
		m.MimeMap["mqy"] = "application/vnd.mobius.mqy"
		m.MimeMap["msl"] = "application/vnd.mobius.msl"
		m.MimeMap["txf"] = "application/vnd.mobius.txf"
		m.MimeMap["daf"] = "application/vnd.mobius.daf"
		m.MimeMap["fly"] = "text/vnd.fly"
		m.MimeMap["mpc"] = "application/vnd.mophun.certificate"
		m.MimeMap["mpn"] = "application/vnd.mophun.application"
		m.MimeMap["mj2"] = "video/mj2"
		m.MimeMap["mpga"] = "audio/mpeg"
		m.MimeMap["mxu"] = "video/vnd.mpegurl"
		m.MimeMap["mpeg"] = "video/mpeg"
		m.MimeMap["m21"] = "application/mp21"
		m.MimeMap["mp4a"] = "audio/mp4"
		m.MimeMap["mp4"] = "video/mp4"
		m.MimeMap["mp4"] = "application/mp4"
		m.MimeMap["m3u8"] = "application/vnd.apple.mpegurl"
		m.MimeMap["mus"] = "application/vnd.musician"
		m.MimeMap["msty"] = "application/vnd.muvee.style"
		m.MimeMap["mxml"] = "application/xv+xml"
		m.MimeMap["ngdat"] = "application/vnd.nokia.n-gage.data"
		m.MimeMap["n-gage"] = "application/vnd.nokia.n-gage.symbian.install"
		m.MimeMap["ncx"] = "application/x-dtbncx+xml"
		m.MimeMap["nc"] = "application/x-netcdf"
		m.MimeMap["nlu"] = "application/vnd.neurolanguage.nlu"
		m.MimeMap["dna"] = "application/vnd.dna"
		m.MimeMap["nnd"] = "application/vnd.noblenet-directory"
		m.MimeMap["nns"] = "application/vnd.noblenet-sealer"
		m.MimeMap["nnw"] = "application/vnd.noblenet-web"
		m.MimeMap["rpst"] = "application/vnd.nokia.radio-preset"
		m.MimeMap["rpss"] = "application/vnd.nokia.radio-presets"
		m.MimeMap["n3"] = "text/n3"
		m.MimeMap["edm"] = "application/vnd.novadigm.edm"
		m.MimeMap["edx"] = "application/vnd.novadigm.edx"
		m.MimeMap["ext"] = "application/vnd.novadigm.ext"
		m.MimeMap["gph"] = "application/vnd.flographit"
		m.MimeMap["ecelp4800"] = "audio/vnd.nuera.ecelp4800"
		m.MimeMap["ecelp7470"] = "audio/vnd.nuera.ecelp7470"
		m.MimeMap["ecelp9600"] = "audio/vnd.nuera.ecelp9600"
		m.MimeMap["oda"] = "application/oda"
		m.MimeMap["ogx"] = "application/ogg"
		m.MimeMap["oga"] = "audio/ogg"
		m.MimeMap["ogv"] = "video/ogg"
		m.MimeMap["dd2"] = "application/vnd.oma.dd2+xml"
		m.MimeMap["oth"] = "application/vnd.oasis.opendocument.text-web"
		m.MimeMap["opf"] = "application/oebps-package+xml"
		m.MimeMap["qbo"] = "application/vnd.intu.qbo"
		m.MimeMap["oxt"] = "application/vnd.openofficeorg.extension"
		m.MimeMap["osf"] = "application/vnd.yamaha.openscoreformat"
		m.MimeMap["weba"] = "audio/webm"
		m.MimeMap["webm"] = "video/webm"
		m.MimeMap["odc"] = "application/vnd.oasis.opendocument.chart"
		m.MimeMap["otc"] = "application/vnd.oasis.opendocument.chart-template"
		m.MimeMap["odb"] = "application/vnd.oasis.opendocument.database"
		m.MimeMap["odf"] = "application/vnd.oasis.opendocument.formula"
		m.MimeMap["odft"] = "application/vnd.oasis.opendocument.formula-template"
		m.MimeMap["odg"] = "application/vnd.oasis.opendocument.graphics"
		m.MimeMap["otg"] = "application/vnd.oasis.opendocument.graphics-template"
		m.MimeMap["odi"] = "application/vnd.oasis.opendocument.image"
		m.MimeMap["oti"] = "application/vnd.oasis.opendocument.image-template"
		m.MimeMap["odp"] = "application/vnd.oasis.opendocument.presentation"
		m.MimeMap["otp"] = "application/vnd.oasis.opendocument.presentation-template"
		m.MimeMap["ods"] = "application/vnd.oasis.opendocument.spreadsheet"
		m.MimeMap["ots"] = "application/vnd.oasis.opendocument.spreadsheet-template"
		m.MimeMap["odt"] = "application/vnd.oasis.opendocument.text"
		m.MimeMap["odm"] = "application/vnd.oasis.opendocument.text-master"
		m.MimeMap["ott"] = "application/vnd.oasis.opendocument.text-template"
		m.MimeMap["ktx"] = "image/ktx"
		m.MimeMap["sxc"] = "application/vnd.sun.xml.calc"
		m.MimeMap["stc"] = "application/vnd.sun.xml.calc.template"
		m.MimeMap["sxd"] = "application/vnd.sun.xml.draw"
		m.MimeMap["std"] = "application/vnd.sun.xml.draw.template"
		m.MimeMap["sxi"] = "application/vnd.sun.xml.impress"
		m.MimeMap["sti"] = "application/vnd.sun.xml.impress.template"
		m.MimeMap["sxm"] = "application/vnd.sun.xml.math"
		m.MimeMap["sxw"] = "application/vnd.sun.xml.writer"
		m.MimeMap["sxg"] = "application/vnd.sun.xml.writer.global"
		m.MimeMap["stw"] = "application/vnd.sun.xml.writer.template"
		m.MimeMap["otf"] = "application/x-font-otf"
		m.MimeMap["osfpvg"] = "application/vnd.yamaha.openscoreformat.osfpvg+xml"
		m.MimeMap["dp"] = "application/vnd.osgi.dp"
		m.MimeMap["pdb"] = "application/vnd.palm"
		m.MimeMap["p"] = "text/x-pascal"
		m.MimeMap["paw"] = "application/vnd.pawaafile"
		m.MimeMap["pclxl"] = "application/vnd.hp-pclxl"
		m.MimeMap["efif"] = "application/vnd.picsel"
		m.MimeMap["pcx"] = "image/x-pcx"
		m.MimeMap["psd"] = "image/vnd.adobe.photoshop"
		m.MimeMap["prf"] = "application/pics-rules"
		m.MimeMap["pic"] = "image/x-pict"
		m.MimeMap["chat"] = "application/x-chat"
		m.MimeMap["p10"] = "application/pkcs10"
		m.MimeMap["p12"] = "application/x-pkcs12"
		m.MimeMap["p7m"] = "application/pkcs7-mime"
		m.MimeMap["p7s"] = "application/pkcs7-signature"
		m.MimeMap["p7r"] = "application/x-pkcs7-certreqresp"
		m.MimeMap["p7b"] = "application/x-pkcs7-certificates"
		m.MimeMap["p8"] = "application/pkcs8"
		m.MimeMap["plf"] = "application/vnd.pocketlearn"
		m.MimeMap["pnm"] = "image/x-portable-anymap"
		m.MimeMap["pbm"] = "image/x-portable-bitmap"
		m.MimeMap["pcf"] = "application/x-font-pcf"
		m.MimeMap["pfr"] = "application/font-tdpfr"
		m.MimeMap["pgn"] = "application/x-chess-pgn"
		m.MimeMap["pgm"] = "image/x-portable-graymap"
		m.MimeMap["png"] = "image/png"
		m.MimeMap["png"] = "image/x-citrix-png"
		m.MimeMap["png"] = "image/x-png"
		m.MimeMap["ppm"] = "image/x-portable-pixmap"
		m.MimeMap["pskcxml"] = "application/pskc+xml"
		m.MimeMap["pml"] = "application/vnd.ctc-posml"
		m.MimeMap["ai"] = "application/postscript"
		m.MimeMap["pfa"] = "application/x-font-type1"
		m.MimeMap["pbd"] = "application/vnd.powerbuilder6"
		m.MimeMap["pgp"] = "application/pgp-encrypted"
		m.MimeMap["pgp"] = "application/pgp-signature"
		m.MimeMap["box"] = "application/vnd.previewsystems.box"
		m.MimeMap["ptid"] = "application/vnd.pvi.ptid1"
		m.MimeMap["pls"] = "application/pls+xml"
		m.MimeMap["str"] = "application/vnd.pg.format"
		m.MimeMap["ei6"] = "application/vnd.pg.osasli"
		m.MimeMap["dsc"] = "text/prs.lines.tag"
		m.MimeMap["psf"] = "application/x-font-linux-psf"
		m.MimeMap["qps"] = "application/vnd.publishare-delta-tree"
		m.MimeMap["wg"] = "application/vnd.pmi.widget"
		m.MimeMap["qxd"] = "application/vnd.quark.quarkxpress"
		m.MimeMap["esf"] = "application/vnd.epson.esf"
		m.MimeMap["msf"] = "application/vnd.epson.msf"
		m.MimeMap["ssf"] = "application/vnd.epson.ssf"
		m.MimeMap["qam"] = "application/vnd.epson.quickanime"
		m.MimeMap["qfx"] = "application/vnd.intu.qfx"
		m.MimeMap["qt"] = "video/quicktime"
		m.MimeMap["rar"] = "application/x-rar-compressed"
		m.MimeMap["ram"] = "audio/x-pn-realaudio"
		m.MimeMap["rmp"] = "audio/x-pn-realaudio-plugin"
		m.MimeMap["rsd"] = "application/rsd+xml"
		m.MimeMap["rm"] = "application/vnd.rn-realmedia"
		m.MimeMap["bed"] = "application/vnd.realvnc.bed"
		m.MimeMap["mxl"] = "application/vnd.recordare.musicxml"
		m.MimeMap["musicxml"] = "application/vnd.recordare.musicxml+xml"
		m.MimeMap["rnc"] = "application/relax-ng-compact-syntax"
		m.MimeMap["rdz"] = "application/vnd.data-vision.rdz"
		m.MimeMap["rdf"] = "application/rdf+xml"
		m.MimeMap["rp9"] = "application/vnd.cloanto.rp9"
		m.MimeMap["jisp"] = "application/vnd.jisp"
		m.MimeMap["rtf"] = "application/rtf"
		m.MimeMap["rtx"] = "text/richtext"
		m.MimeMap["link66"] = "application/vnd.route66.link66+xml"
		m.MimeMap["rss"] = "application/rss+xml"
		m.MimeMap["shf"] = "application/shf+xml"
		m.MimeMap["st"] = "application/vnd.sailingtracker.track"
		m.MimeMap["svg"] = "image/svg+xml"
		m.MimeMap["sus"] = "application/vnd.sus-calendar"
		m.MimeMap["sru"] = "application/sru+xml"
		m.MimeMap["setpay"] = "application/set-payment-initiation"
		m.MimeMap["setreg"] = "application/set-registration-initiation"
		m.MimeMap["sema"] = "application/vnd.sema"
		m.MimeMap["semd"] = "application/vnd.semd"
		m.MimeMap["semf"] = "application/vnd.semf"
		m.MimeMap["see"] = "application/vnd.seemail"
		m.MimeMap["snf"] = "application/x-font-snf"
		m.MimeMap["spq"] = "application/scvp-vp-request"
		m.MimeMap["spp"] = "application/scvp-vp-response"
		m.MimeMap["scq"] = "application/scvp-cv-request"
		m.MimeMap["scs"] = "application/scvp-cv-response"
		m.MimeMap["sdp"] = "application/sdp"
		m.MimeMap["etx"] = "text/x-setext"
		m.MimeMap["movie"] = "video/x-sgi-movie"
		m.MimeMap["ifm"] = "application/vnd.shana.informed.formdata"
		m.MimeMap["itp"] = "application/vnd.shana.informed.formtemplate"
		m.MimeMap["iif"] = "application/vnd.shana.informed.interchange"
		m.MimeMap["ipk"] = "application/vnd.shana.informed.package"
		m.MimeMap["tfi"] = "application/thraud+xml"
		m.MimeMap["shar"] = "application/x-shar"
		m.MimeMap["rgb"] = "image/x-rgb"
		m.MimeMap["slt"] = "application/vnd.epson.salt"
		m.MimeMap["aso"] = "application/vnd.accpac.simply.aso"
		m.MimeMap["imp"] = "application/vnd.accpac.simply.imp"
		m.MimeMap["twd"] = "application/vnd.simtech-mindmapper"
		m.MimeMap["csp"] = "application/vnd.commonspace"
		m.MimeMap["saf"] = "application/vnd.yamaha.smaf-audio"
		m.MimeMap["mmf"] = "application/vnd.smaf"
		m.MimeMap["spf"] = "application/vnd.yamaha.smaf-phrase"
		m.MimeMap["teacher"] = "application/vnd.smart.teacher"
		m.MimeMap["svd"] = "application/vnd.svd"
		m.MimeMap["rq"] = "application/sparql-query"
		m.MimeMap["srx"] = "application/sparql-results+xml"
		m.MimeMap["gram"] = "application/srgs"
		m.MimeMap["grxml"] = "application/srgs+xml"
		m.MimeMap["ssml"] = "application/ssml+xml"
		m.MimeMap["skp"] = "application/vnd.koan"
		m.MimeMap["sgml"] = "text/sgml"
		m.MimeMap["sdc"] = "application/vnd.stardivision.calc"
		m.MimeMap["sda"] = "application/vnd.stardivision.draw"
		m.MimeMap["sdd"] = "application/vnd.stardivision.impress"
		m.MimeMap["smf"] = "application/vnd.stardivision.math"
		m.MimeMap["sdw"] = "application/vnd.stardivision.writer"
		m.MimeMap["sgl"] = "application/vnd.stardivision.writer-global"
		m.MimeMap["sm"] = "application/vnd.stepmania.stepchart"
		m.MimeMap["sit"] = "application/x-stuffit"
		m.MimeMap["sitx"] = "application/x-stuffitx"
		m.MimeMap["sdkm"] = "application/vnd.solent.sdkm+xml"
		m.MimeMap["xo"] = "application/vnd.olpc-sugar"
		m.MimeMap["au"] = "audio/basic"
		m.MimeMap["wqd"] = "application/vnd.wqd"
		m.MimeMap["sis"] = "application/vnd.symbian.install"
		m.MimeMap["smi"] = "application/smil+xml"
		m.MimeMap["xsm"] = "application/vnd.syncml+xml"
		m.MimeMap["bdm"] = "application/vnd.syncml.dm+wbxml"
		m.MimeMap["xdm"] = "application/vnd.syncml.dm+xml"
		m.MimeMap["sv4cpio"] = "application/x-sv4cpio"
		m.MimeMap["sv4crc"] = "application/x-sv4crc"
		m.MimeMap["sbml"] = "application/sbml+xml"
		m.MimeMap["tsv"] = "text/tab-separated-values"
		m.MimeMap["tiff"] = "image/tiff"
		m.MimeMap["tao"] = "application/vnd.tao.intent-module-archive"
		m.MimeMap["tar"] = "application/x-tar"
		m.MimeMap["tcl"] = "application/x-tcl"
		m.MimeMap["tex"] = "application/x-tex"
		m.MimeMap["tfm"] = "application/x-tex-tfm"
		m.MimeMap["tei"] = "application/tei+xml"
		m.MimeMap["txt"] = "text/plain"
		m.MimeMap["dxp"] = "application/vnd.spotfire.dxp"
		m.MimeMap["sfs"] = "application/vnd.spotfire.sfs"
		m.MimeMap["tsd"] = "application/timestamped-data"
		m.MimeMap["tpt"] = "application/vnd.trid.tpt"
		m.MimeMap["mxs"] = "application/vnd.triscape.mxs"
		m.MimeMap["t"] = "text/troff"
		m.MimeMap["tra"] = "application/vnd.trueapp"
		m.MimeMap["ttf"] = "application/x-font-ttf"
		m.MimeMap["ttl"] = "text/turtle"
		m.MimeMap["umj"] = "application/vnd.umajin"
		m.MimeMap["uoml"] = "application/vnd.uoml+xml"
		m.MimeMap["unityweb"] = "application/vnd.unity"
		m.MimeMap["ufd"] = "application/vnd.ufdl"
		m.MimeMap["uri"] = "text/uri-list"
		m.MimeMap["utz"] = "application/vnd.uiq.theme"
		m.MimeMap["ustar"] = "application/x-ustar"
		m.MimeMap["uu"] = "text/x-uuencode"
		m.MimeMap["vcs"] = "text/x-vcalendar"
		m.MimeMap["vcf"] = "text/x-vcard"
		m.MimeMap["vcd"] = "application/x-cdlink"
		m.MimeMap["vsf"] = "application/vnd.vsf"
		m.MimeMap["wrl"] = "model/vrml"
		m.MimeMap["vcx"] = "application/vnd.vcx"
		m.MimeMap["mts"] = "model/vnd.mts"
		m.MimeMap["vtu"] = "model/vnd.vtu"
		m.MimeMap["vis"] = "application/vnd.visionary"
		m.MimeMap["viv"] = "video/vnd.vivo"
		m.MimeMap["ccxml"] = "application/ccxml+xml,"
		m.MimeMap["vxml"] = "application/voicexml+xml"
		m.MimeMap["src"] = "application/x-wais-source"
		m.MimeMap["wbxml"] = "application/vnd.wap.wbxml"
		m.MimeMap["wbmp"] = "image/vnd.wap.wbmp"
		m.MimeMap["wav"] = "audio/x-wav"
		m.MimeMap["davmount"] = "application/davmount+xml"
		m.MimeMap["woff"] = "application/x-font-woff"
		m.MimeMap["wspolicy"] = "application/wspolicy+xml"
		m.MimeMap["webp"] = "image/webp"
		m.MimeMap["wtb"] = "application/vnd.webturbo"
		m.MimeMap["wgt"] = "application/widget"
		m.MimeMap["hlp"] = "application/winhlp"
		m.MimeMap["wml"] = "text/vnd.wap.wml"
		m.MimeMap["wmls"] = "text/vnd.wap.wmlscript"
		m.MimeMap["wmlsc"] = "application/vnd.wap.wmlscriptc"
		m.MimeMap["wpd"] = "application/vnd.wordperfect"
		m.MimeMap["stf"] = "application/vnd.wt.stf"
		m.MimeMap["wsdl"] = "application/wsdl+xml"
		m.MimeMap["xbm"] = "image/x-xbitmap"
		m.MimeMap["xpm"] = "image/x-xpixmap"
		m.MimeMap["xwd"] = "image/x-xwindowdump"
		m.MimeMap["der"] = "application/x-x509-ca-cert"
		m.MimeMap["fig"] = "application/x-xfig"
		m.MimeMap["xhtml"] = "application/xhtml+xml"
		m.MimeMap["xml"] = "application/xml"
		m.MimeMap["xdf"] = "application/xcap-diff+xml"
		m.MimeMap["xenc"] = "application/xenc+xml"
		m.MimeMap["xer"] = "application/patch-ops-error+xml"
		m.MimeMap["rl"] = "application/resource-lists+xml"
		m.MimeMap["rs"] = "application/rls-services+xml"
		m.MimeMap["rld"] = "application/resource-lists-diff+xml"
		m.MimeMap["xslt"] = "application/xslt+xml"
		m.MimeMap["xop"] = "application/xop+xml"
		m.MimeMap["xpi"] = "application/x-xpinstall"
		m.MimeMap["xspf"] = "application/xspf+xml"
		m.MimeMap["xul"] = "application/vnd.mozilla.xul+xml"
		m.MimeMap["xyz"] = "chemical/x-xyz"
		m.MimeMap["yaml"] = "text/yaml"
		m.MimeMap["yang"] = "application/yang"
		m.MimeMap["yin"] = "application/yin+xml"
		m.MimeMap["zir"] = "application/vnd.zul"
		m.MimeMap["zip"] = "application/zip"
		m.MimeMap["zmm"] = "application/vnd.handheld-entertainment+xml"
		m.MimeMap["zaz"] = "application/vnd.zzazz.deck+xml"
	}
	if typ, ok := m.MimeMap[ex]; ok {
		return typ, nil
	} else {
		return "", fmt.Errorf("no mime type for extension : %s", extension)
	}
}